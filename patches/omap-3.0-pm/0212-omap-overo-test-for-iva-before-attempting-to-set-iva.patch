From c829992638de08f3c27e4cf96580a5ac01d7a71e Mon Sep 17 00:00:00 2001
From: Steve Sakoman <steve@sakoman.com>
Date: Wed, 18 Jan 2012 09:54:35 -0800
Subject: [PATCH 212/214] omap: overo: test for iva before attempting to set
 iva opp

---
 arch/arm/mach-omap2/board-overo.c |   16 ++++++++++------
 1 files changed, 10 insertions(+), 6 deletions(-)

diff --git a/arch/arm/mach-omap2/board-overo.c b/arch/arm/mach-omap2/board-overo.c
index e6d2441..12dc73f 100644
--- a/arch/arm/mach-omap2/board-overo.c
+++ b/arch/arm/mach-omap2/board-overo.c
@@ -620,9 +620,11 @@ static void __init overo_opp_init(void)
 		r |= opp_enable(dev, 1000000000);
 
 		/* Enable IVA 800MHz and lower opps */
-		dev = &dh->od->pdev.dev;
-		r |= opp_enable(dev, 660000000);
-		r |= opp_enable(dev, 800000000);
+		if (omap3_has_iva()) {
+			dev = &dh->od->pdev.dev;
+			r |= opp_enable(dev, 660000000);
+			r |= opp_enable(dev, 800000000);
+		}
 
 		if (r) {
 			pr_err("%s: failed to enable higher opp %d\n",
@@ -634,9 +636,11 @@ static void __init overo_opp_init(void)
 			dev = &mh->od->pdev.dev;
 			opp_disable(dev, 800000000);
 			opp_disable(dev, 1000000000);
-			dev = &dh->od->pdev.dev;
-			opp_disable(dev, 660000000);
-			opp_disable(dev, 800000000);
+			if (omap3_has_iva()) {
+				dev = &dh->od->pdev.dev;
+				opp_disable(dev, 660000000);
+				opp_disable(dev, 800000000);
+			}
 		}
 	}
 	return;
-- 
1.7.5.4

