From 9bf18a9822fa051467f95cbdd3e835ffac8c3b3b Mon Sep 17 00:00:00 2001
From: Robert Nelson <robertcnelson@gmail.com>
Date: Thu, 16 Sep 2010 16:42:04 -0500
Subject: [PATCH 4/5] ARM OMAP Touchbook upstream power off

---
 arch/arm/mach-omap2/board-omap3touchbook.c |   10 +++++-----
 1 files changed, 5 insertions(+), 5 deletions(-)

diff --git a/arch/arm/mach-omap2/board-omap3touchbook.c b/arch/arm/mach-omap2/board-omap3touchbook.c
index d081c20..001f3e6 100644
--- a/arch/arm/mach-omap2/board-omap3touchbook.c
+++ b/arch/arm/mach-omap2/board-omap3touchbook.c
@@ -61,7 +61,6 @@
 
 #define OMAP3_AC_GPIO		136
 #define TB_BL_PWM_TIMER		9
-#define TB_KILL_POWER_GPIO	168
 
 unsigned long touchbook_revision;
 
@@ -602,22 +601,23 @@ static void __init touchbook_mma7455l_init(void)
 	gpio_direction_input(touchbook_mma7455l_gpio);
 }
 
-static void omap3_touchbook_poweroff(void)
+static void touchbook_poweroff(void)
 {
 	int r;
+	int touchbook_kill_power_gpio = 168;
 
-	r = gpio_request(TB_KILL_POWER_GPIO, "DVI reset");
+	r = gpio_request(touchbook_kill_power_gpio, "power reset");
 	if (r < 0) {
 		printk(KERN_ERR "Unable to get kill power GPIO\n");
 		return;
 	}
 
-	gpio_direction_output(TB_KILL_POWER_GPIO, 0);
+	gpio_direction_output(touchbook_kill_power_gpio, 0);
 }
 
 static void __init touchbook_init(void)
 {
-	pm_power_off = omap3_touchbook_poweroff;
+	pm_power_off = touchbook_poweroff;
 
 	omap3_mux_init(touchbook_board_mux, OMAP_PACKAGE_CBB);
 	touchbook_i2c_init();
-- 
1.7.0.4

