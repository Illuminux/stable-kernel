From 0254026d2814feaaf41c8187db9201487f38fffd Mon Sep 17 00:00:00 2001
From: Shivananda Hebbar <x0hebbar@ti.com>
Date: Mon, 19 Apr 2010 18:15:08 -0500
Subject: [PATCH 044/135] DSPBRIDGE: replace error code DSP_ENOMORECONNECTIONS for -ECONNREFUSED

This patch replaces DSP_ENOMORECONNECTIONS with -ECONNREFUSED.

Signed-off-by: Shivananda Hebbar <x0hebbar@ti.com>
---
 arch/arm/plat-omap/include/dspbridge/node.h |    2 +-
 drivers/dsp/bridge/rmgr/node.c              |    4 ++--
 2 files changed, 3 insertions(+), 3 deletions(-)

diff --git a/arch/arm/plat-omap/include/dspbridge/node.h b/arch/arm/plat-omap/include/dspbridge/node.h
index 863efb0..c04e4b3 100644
--- a/arch/arm/plat-omap/include/dspbridge/node.h
+++ b/arch/arm/plat-omap/include/dspbridge/node.h
@@ -172,7 +172,7 @@ extern dsp_status node_close_orphans(struct node_mgr *hnode_mgr,
  *                              indices uStream1 or uStream2.
  *      DSP_EWRONGSTATE:        Either hNode1 or hNode2 is not in the
  *                              NODE_ALLOCATED state.
- *      DSP_ENOMORECONNECTIONS: No more connections available.
+ *      -ECONNREFUSED: No more connections available.
  *      -EPERM:              Attempt to make an illegal connection (eg,
  *                              Device node to device node, or device node to
  *                              GPP), the two nodes are on different DSPs.
diff --git a/drivers/dsp/bridge/rmgr/node.c b/drivers/dsp/bridge/rmgr/node.c
index f6cc6c0..154658e 100644
--- a/drivers/dsp/bridge/rmgr/node.c
+++ b/drivers/dsp/bridge/rmgr/node.c
@@ -955,7 +955,7 @@ dsp_status node_connect(struct node_object *hNode1, u32 uStream1,
 		/* Find available pipe */
 		pipe_id = gb_findandset(hnode_mgr->pipe_map);
 		if (pipe_id == GB_NOBITS) {
-			status = DSP_ENOMORECONNECTIONS;
+			status = -ECONNREFUSED;
 		} else {
 			hNode1->outputs[uStream1].type = NODECONNECT;
 			hNode2->inputs[uStream2].type = NODECONNECT;
@@ -1027,7 +1027,7 @@ dsp_status node_connect(struct node_object *hNode1, u32 uStream1,
 			chnl_id = gb_findandset(hnode_mgr->chnl_map);
 		}
 		if (chnl_id == GB_NOBITS) {
-			status = DSP_ENOMORECONNECTIONS;
+			status = -ECONNREFUSED;
 			goto func_cont2;
 		}
 		pstr_dev_name = mem_calloc(HOSTNAMELEN + 1, MEM_PAGED);
-- 
1.7.0.4

