From b4eb5fbbd0b1a4f59168d89f387ec9e943a6055c Mon Sep 17 00:00:00 2001
From: Robert Nelson <robertcnelson@gmail.com>
Date: Wed, 23 Mar 2011 11:28:19 -0500
Subject: [PATCH] omap3: beaglexm: fix user button

from: http://www.spinics.net/lists/linux-omap/msg48672.html
added xMC check

Signed-off-by: Robert Nelson <robertcnelson@gmail.com>
---
 arch/arm/mach-omap2/board-omap3beagle.c |    7 +++++++
 1 files changed, 7 insertions(+), 0 deletions(-)

diff --git a/arch/arm/mach-omap2/board-omap3beagle.c b/arch/arm/mach-omap2/board-omap3beagle.c
index d7881e8..10b33d7 100644
--- a/arch/arm/mach-omap2/board-omap3beagle.c
+++ b/arch/arm/mach-omap2/board-omap3beagle.c
@@ -802,6 +802,13 @@ static void __init omap3_beagle_init(void)
 	omap3_mux_init(board_mux, OMAP_PACKAGE_CBB);
 	omap3_beagle_init_rev();
 	omap3_beagle_i2c_init();
+
+	/* xM version uses pin 4 instead of 7 for user button */
+	if ((omap3_beagle_get_rev() == OMAP3BEAGLE_BOARD_XM) ||
+		(omap3_beagle_get_rev() == OMAP3BEAGLE_BOARD_XMC)){
+		gpio_buttons[0].gpio = 4;
+	}
+
 	platform_add_devices(omap3_beagle_devices,
 			ARRAY_SIZE(omap3_beagle_devices));
 	omap_display_init(&beagle_dss_data);
-- 
1.7.1

